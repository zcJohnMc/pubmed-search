{% extends "base.html" %}

{% block title %}搜索历史 - AI PubMed Search{% endblock %}

{% block content %}
<div class="history-container">
    <div class="history-header">
        <h1><i class="fas fa-history"></i> 搜索历史</h1>
        <p>查看和管理您的搜索记录</p>
    </div>

    {% if history %}
    <div class="history-list">
        {% for record in history %}
        <div class="history-item">
            <div class="history-content">
                <div class="history-main">
                    <h3 class="history-query">{{ record.final_query }}</h3>
                    {% if record.user_topic %}
                    <p class="history-topic">
                        <i class="fas fa-lightbulb"></i>
                        主题: {{ record.user_topic }}
                    </p>
                    {% endif %}
                </div>
                
                <div class="history-meta">
                    <div class="meta-row">
                        <span class="meta-item">
                            <i class="fas fa-calendar"></i>
                            {{ record.search_date }}
                        </span>
                        <span class="meta-item">
                            <i class="fas fa-file-alt"></i>
                            {{ record.filtered_results }} 篇结果
                        </span>
                    </div>
                    
                    {% if record.journal_filter %}
                    <div class="meta-row">
                        <span class="meta-item">
                            <i class="fas fa-book"></i>
                            {{ record.journal_filter }}
                        </span>
                    </div>
                    {% endif %}
                    
                    {% if record.year_range %}
                    <div class="meta-row">
                        <span class="meta-item">
                            <i class="fas fa-clock"></i>
                            {{ record.year_range }}
                        </span>
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <div class="history-actions">
                <a href="{{ url_for('view_history', search_id=record.id) }}" class="btn btn-sm btn-primary">
                    <i class="fas fa-eye"></i> 查看
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <i class="fas fa-search"></i>
        <h3>暂无搜索历史</h3>
        <p>开始您的第一次搜索吧！</p>
        <a href="{{ url_for('search_page') }}" class="btn btn-primary">
            <i class="fas fa-search"></i> 开始搜索
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script>
function viewSearch(searchId) {
    // 这里可以实现查看历史搜索的功能
    showToast('功能开发中...', 'info');
}
</script>
{% endblock %}
